<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_292) on Fri Mar 03 16:01:38 UTC 2023 -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>AbstractLockResolverClient (TiKV Java Client 3.3.0-SNAPSHOT API)</title>
<meta name="date" content="2023-03-03">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AbstractLockResolverClient (TiKV Java Client 3.3.0-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":17,"i1":17,"i2":6,"i3":6};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"],16:["t5","Default Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractLockResolverClient.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../org/tikv/txn/KVClient.html" title="class in org.tikv.txn"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/tikv/txn/AbstractLockResolverClient.html" target="_top">Frames</a></li>
<li><a href="AbstractLockResolverClient.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.tikv.txn</div>
<h2 title="Interface AbstractLockResolverClient" class="title">Interface AbstractLockResolverClient</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Implementing Classes:</dt>
<dd><a href="../../../org/tikv/txn/LockResolverClientV2.html" title="class in org.tikv.txn">LockResolverClientV2</a>, <a href="../../../org/tikv/txn/LockResolverClientV3.html" title="class in org.tikv.txn">LockResolverClientV3</a>, <a href="../../../org/tikv/txn/LockResolverClientV4.html" title="class in org.tikv.txn">LockResolverClientV4</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">AbstractLockResolverClient</span></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#BIG_TXN_THRESHOLD">BIG_TXN_THRESHOLD</a></span></code>
<div class="block">transaction involves keys exceed this threshold can be treated as `big transaction`.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#RESOLVED_TXN_CACHE_SIZE">RESOLVED_TXN_CACHE_SIZE</a></span></code>
<div class="block">ResolvedCacheSize is max number of cached txn status.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t5" class="tableTab"><span><a href="javascript:show(16);">Default Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>static <a href="../../../org/tikv/txn/Lock.html" title="class in org.tikv.txn">Lock</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#extractLockFromKeyErr-org.tikv.kvproto.Kvrpcpb.KeyError-org.tikv.common.apiversion.RequestKeyCodec-">extractLockFromKeyErr</a></span>(<a href="../../../org/tikv/kvproto/Kvrpcpb.KeyError.html" title="class in org.tikv.kvproto">Kvrpcpb.KeyError</a>&nbsp;keyError,
                     <a href="../../../org/tikv/common/apiversion/RequestKeyCodec.html" title="interface in org.tikv.common.apiversion">RequestKeyCodec</a>&nbsp;codec)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../../org/tikv/txn/AbstractLockResolverClient.html" title="interface in org.tikv.txn">AbstractLockResolverClient</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#getInstance-org.tikv.common.TiConfiguration-org.tikv.common.region.TiRegion-org.tikv.common.region.TiStore-org.tikv.kvproto.TikvGrpc.TikvBlockingStub-org.tikv.kvproto.TikvGrpc.TikvFutureStub-org.tikv.common.util.ChannelFactory-org.tikv.common.region.RegionManager-org.tikv.common.PDClient-org.tikv.common.region.RegionStoreClient.RegionStoreClientBuilder-">getInstance</a></span>(<a href="../../../org/tikv/common/TiConfiguration.html" title="class in org.tikv.common">TiConfiguration</a>&nbsp;conf,
           <a href="../../../org/tikv/common/region/TiRegion.html" title="class in org.tikv.common.region">TiRegion</a>&nbsp;region,
           <a href="../../../org/tikv/common/region/TiStore.html" title="class in org.tikv.common.region">TiStore</a>&nbsp;store,
           <a href="../../../org/tikv/kvproto/TikvGrpc.TikvBlockingStub.html" title="class in org.tikv.kvproto">TikvGrpc.TikvBlockingStub</a>&nbsp;blockingStub,
           <a href="../../../org/tikv/kvproto/TikvGrpc.TikvFutureStub.html" title="class in org.tikv.kvproto">TikvGrpc.TikvFutureStub</a>&nbsp;asyncStub,
           <a href="../../../org/tikv/common/util/ChannelFactory.html" title="class in org.tikv.common.util">ChannelFactory</a>&nbsp;channelFactory,
           <a href="../../../org/tikv/common/region/RegionManager.html" title="class in org.tikv.common.region">RegionManager</a>&nbsp;regionManager,
           <a href="../../../org/tikv/common/PDClient.html" title="class in org.tikv.common">PDClient</a>&nbsp;pdClient,
           <a href="../../../org/tikv/common/region/RegionStoreClient.RegionStoreClientBuilder.html" title="class in org.tikv.common.region">RegionStoreClient.RegionStoreClientBuilder</a>&nbsp;clientBuilder)</code>&nbsp;</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#getVersion--">getVersion</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../org/tikv/txn/ResolveLockResult.html" title="class in org.tikv.txn">ResolveLockResult</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/tikv/txn/AbstractLockResolverClient.html#resolveLocks-org.tikv.common.util.BackOffer-long-java.util.List-boolean-">resolveLocks</a></span>(<a href="../../../org/tikv/common/util/BackOffer.html" title="interface in org.tikv.common.util">BackOffer</a>&nbsp;bo,
            long&nbsp;callerStartTS,
            <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../org/tikv/txn/Lock.html" title="class in org.tikv.txn">Lock</a>&gt;&nbsp;locks,
            boolean&nbsp;forWrite)</code>
<div class="block">ResolveLocks tries to resolve Locks.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="RESOLVED_TXN_CACHE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>RESOLVED_TXN_CACHE_SIZE</h4>
<pre>static final&nbsp;long RESOLVED_TXN_CACHE_SIZE</pre>
<div class="block">ResolvedCacheSize is max number of cached txn status.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.tikv.txn.AbstractLockResolverClient.RESOLVED_TXN_CACHE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="BIG_TXN_THRESHOLD">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BIG_TXN_THRESHOLD</h4>
<pre>static final&nbsp;long BIG_TXN_THRESHOLD</pre>
<div class="block">transaction involves keys exceed this threshold can be treated as `big transaction`.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#org.tikv.txn.AbstractLockResolverClient.BIG_TXN_THRESHOLD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="extractLockFromKeyErr-org.tikv.kvproto.Kvrpcpb.KeyError-org.tikv.common.apiversion.RequestKeyCodec-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>extractLockFromKeyErr</h4>
<pre>static&nbsp;<a href="../../../org/tikv/txn/Lock.html" title="class in org.tikv.txn">Lock</a>&nbsp;extractLockFromKeyErr(<a href="../../../org/tikv/kvproto/Kvrpcpb.KeyError.html" title="class in org.tikv.kvproto">Kvrpcpb.KeyError</a>&nbsp;keyError,
                                  <a href="../../../org/tikv/common/apiversion/RequestKeyCodec.html" title="interface in org.tikv.common.apiversion">RequestKeyCodec</a>&nbsp;codec)</pre>
</li>
</ul>
<a name="getInstance-org.tikv.common.TiConfiguration-org.tikv.common.region.TiRegion-org.tikv.common.region.TiStore-org.tikv.kvproto.TikvGrpc.TikvBlockingStub-org.tikv.kvproto.TikvGrpc.TikvFutureStub-org.tikv.common.util.ChannelFactory-org.tikv.common.region.RegionManager-org.tikv.common.PDClient-org.tikv.common.region.RegionStoreClient.RegionStoreClientBuilder-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInstance</h4>
<pre>static&nbsp;<a href="../../../org/tikv/txn/AbstractLockResolverClient.html" title="interface in org.tikv.txn">AbstractLockResolverClient</a>&nbsp;getInstance(<a href="../../../org/tikv/common/TiConfiguration.html" title="class in org.tikv.common">TiConfiguration</a>&nbsp;conf,
                                              <a href="../../../org/tikv/common/region/TiRegion.html" title="class in org.tikv.common.region">TiRegion</a>&nbsp;region,
                                              <a href="../../../org/tikv/common/region/TiStore.html" title="class in org.tikv.common.region">TiStore</a>&nbsp;store,
                                              <a href="../../../org/tikv/kvproto/TikvGrpc.TikvBlockingStub.html" title="class in org.tikv.kvproto">TikvGrpc.TikvBlockingStub</a>&nbsp;blockingStub,
                                              <a href="../../../org/tikv/kvproto/TikvGrpc.TikvFutureStub.html" title="class in org.tikv.kvproto">TikvGrpc.TikvFutureStub</a>&nbsp;asyncStub,
                                              <a href="../../../org/tikv/common/util/ChannelFactory.html" title="class in org.tikv.common.util">ChannelFactory</a>&nbsp;channelFactory,
                                              <a href="../../../org/tikv/common/region/RegionManager.html" title="class in org.tikv.common.region">RegionManager</a>&nbsp;regionManager,
                                              <a href="../../../org/tikv/common/PDClient.html" title="class in org.tikv.common">PDClient</a>&nbsp;pdClient,
                                              <a href="../../../org/tikv/common/region/RegionStoreClient.RegionStoreClientBuilder.html" title="class in org.tikv.common.region">RegionStoreClient.RegionStoreClientBuilder</a>&nbsp;clientBuilder)</pre>
</li>
</ul>
<a name="getVersion--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVersion</h4>
<pre><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;getVersion()</pre>
</li>
</ul>
<a name="resolveLocks-org.tikv.common.util.BackOffer-long-java.util.List-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>resolveLocks</h4>
<pre><a href="../../../org/tikv/txn/ResolveLockResult.html" title="class in org.tikv.txn">ResolveLockResult</a>&nbsp;resolveLocks(<a href="../../../org/tikv/common/util/BackOffer.html" title="interface in org.tikv.common.util">BackOffer</a>&nbsp;bo,
                               long&nbsp;callerStartTS,
                               <a href="https://docs.oracle.com/javase/8/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../org/tikv/txn/Lock.html" title="class in org.tikv.txn">Lock</a>&gt;&nbsp;locks,
                               boolean&nbsp;forWrite)</pre>
<div class="block">ResolveLocks tries to resolve Locks. The resolving process is in 3 steps: 1) Use the `lockTTL`
 to pick up all expired locks. Only locks that are old enough are considered orphan locks and
 will be handled later. If all locks are expired then all locks will be resolved so true will be
 returned, otherwise caller should sleep a while before retry. 2) For each lock, query the
 primary key to get txn(which left the lock)'s commit status. 3) Send `ResolveLock` cmd to the
 lock's region to resolve all locks belong to the same transaction.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bo</code> - </dd>
<dd><code>callerStartTS</code> - </dd>
<dd><code>locks</code> - </dd>
<dd><code>forWrite</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>msBeforeTxnExpired: 0 means all locks are resolved</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractLockResolverClient.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../org/tikv/txn/KVClient.html" title="class in org.tikv.txn"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/tikv/txn/AbstractLockResolverClient.html" target="_top">Frames</a></li>
<li><a href="AbstractLockResolverClient.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>Copyright &#169; 2023 PingCAP. All rights reserved.</small></p>
</body>
</html>
